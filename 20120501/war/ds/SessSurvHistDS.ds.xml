<DataSource
	ID="SessSurvHistDS"
	serverType="sql"
	tableName="survey"
	qualifyColumnNames="false">
	<fields>
		<field name="survey_id"					type="integer"	title="ID"	hidden="true" primaryKey="true" />
		<field name="p_numb"					type="text"		title="phone"/>
		<field name="survey_descript"			type="text" 	title="Survey Text"/>		
		<field name="survey_creator"			type="text" 	title="Rec User"/>
		<field name="loked_user"				type="text" 	title="UPD User"/>
		<field name="survey_reply_type_name"	type="text" 	title="Response Type"/>
		<field name="survery_responce_status"	type="integer"	title="Execution Status"/>
	</fields>
	
	<operationBindings>
		<operationBinding operationId="sessDiscCustSearch" operationType="fetch" 
    		customFields="survey_id, phone, survey_descript , rec_user, upd_user, survey_reply_type_name ,survery_responce_status">
    		<selectClause>  
    			t.survey_id,
  				t.phone,
  				t.survey_descript,
  				(r.user_name||' ( '||r.personnel_name||' '||r.personnel_surname||' ) ') as survey_creator,
  				(d.user_name||' ( '||d.personnel_name||' '||d.personnel_surname||' ) ') as loked_user,
  				dt.survey_reply_type_name,
  				t.survery_responce_status
			</selectClause> 
			<tableClause>survey t, personnel r, personnel d, survey_reply_type dt</tableClause>
			<whereClause><![CDATA[ 
				r.user_name = t.survey_creator and 
				d.user_name = t.loked_user and
				t.survey_reply_type_id = dt.survey_reply_type_id(+) and
				t.session_call_id=$criteria.sessionId		
				]]>  
			</whereClause> 
    	</operationBinding>    	
    </operationBindings>	
</DataSource>