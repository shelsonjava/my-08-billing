<DataSource 
    	ID="UsersDS" 
    	serverType="sql" 
    	tableName="users"
		qualifyColumnNames="false" 
		dropExtraFields="false">
	<fields>
		<field name="user_id" 				type="integer" 		title="id" 					hidden="true" 	primaryKey="true" />
		<field name="user_firstname" 		type="text" 		title="user_firstname" />
		<field name="user_lastname" 		type="text" 		title="user_lastname" />
		<field name="user_name" 			type="text" 		title="User user_name" />
		<field name="user_password" 		type="text" 		title="user_password" />
		<field name="fullUserName" 			type="text" 		title="fullUserName" 		hidden="true" />
		<field name="loggedUserName" 		type="text" 		title="loggedUserName"		hidden="true" />
		<field name="user_department_id" 	type="integer" 		title="user_department_id"	hidden="true" />
		<field name="department_name" 		type="text" 		title="department_name" />
		<field name="schedule_txt" 			type="text" 		title="schedule_txt"		hidden="true" />
		<field name="aaaaaa" 				type="text" 		title="aaaaaa" 				hidden="true" />
		<field name="fullPersonName" 		type="text" 		title="fullPersonName" 		hidden="true" />
		<field name="sip_user_name" 		type="text" 		title="sip_user_name" 	 	hidden="true" />
		<field name="sip_password" 			type="text" 		title="sip_password" 	 	hidden="true" />
	</fields>

	<serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.UsersDMI" />

	<operationBindings>
		<!-- Add User -->
		<operationBinding operationId="addUser" operationType="add" serverMethod="addUser">
			<serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.UsersDMI" />
		</operationBinding>

		<!-- Modify User -->
		<operationBinding operationId="updateUser" operationType="update" serverMethod="updateUser">
		    <serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.UsersDMI" />
		</operationBinding>

		<!-- Modify User Status -->
		<operationBinding operationId="deleteUser" operationType="remove" serverMethod="deleteUser">
			<serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.UsersDMI" />
		</operationBinding>

		<!-- Custom Search -->
		<operationBinding operationId="searchUser" operationType="fetch" serverMethod="fetchOrderedUsers">
			<serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.UsersDMI" />
		</operationBinding>

		<!-- Custom Search Cached -->
		<operationBinding operationId="searchAllUser" operationType="fetch" serverMethod="fetchAllUsers">
			<serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.UsersDMI" />
		</operationBinding>

		<!-- Custom Search - DB -->
		<operationBinding operationId="searchAllUserFromDB" operationType="fetch" serverMethod="fetchAllUsersFromDB">
			<serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.UsersDMI" />
		</operationBinding>

		<!-- Login -->
		<operationBinding operationId="login" operationType="add" serverMethod="login">
		    <serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.UsersDMI" />
		</operationBinding>

		<!-- FETCH - For CallCenter -->
		<operationBinding operationId="getOperatorBreak" operationType="fetch">
			<customSQL>
            	 <![CDATA[
					select 
       					'თარიღი : '||to_char(ob.break_date,'dd-mm-yyyy')||', დრო : '||ob.break_time as schedule_txt
					from 
						operator_breaks ob 
					where 
						to_char(ob.break_date,'dd/mm/yy')=to_char(sysdate,'dd/mm/yy') and ob.user_id = $criteria.user_id
            	 ]]>
			</customSQL>
		</operationBinding>
		
		
		<!-- Custom Search -->
		<operationBinding operationId="searchUser11" operationType="fetch">
			<selectClause>
				u.user_id,
				u.user_name||' ( '||u.user_firstname||' '||u.user_lastname||' ) ' as fullPersonName				
			</selectClause>
			<tableClause>users u</tableClause>
			<whereClause><![CDATA[
				1 = 1
				]]>
			</whereClause>
			<orderClause>u.user_lastname desc</orderClause>
		    
		    
		</operationBinding>
		
		<operationBinding operationId="getOperatorBreaksComboUserName" operationType="fetch">
			<selectClause>
				u.user_id,
				u.user_firstname,
				u.user_lastname,
				u.user_firstname || ' ' || u.user_lastname as fullUserName,
				u.department_id,
				u.user_name
			</selectClause>
			<tableClause>users u</tableClause>
			<whereClause><![CDATA[
				1 = 1 and u.department_id = 50004
				#if($criteria.fullUserName) and u.user_firstname || ' ' || u.user_lastname like '%'||$criteria.fullUserName||'%' #end
				#if($criteria.user_name) and u.user_name like '%'||$criteria.user_name||'%' #end
				#if($criteria.user_id) and u.user_id = $criteria.user_id #end
				]]>
			</whereClause>
			<orderClause>u.user_lastname desc</orderClause>
		</operationBinding>
		
	
		<operationBinding operationId="getUserForCombo" operationType="fetch">
			<selectClause>
				user_id,
				user_name|| ' ( '||user_firstname||' '||user_lastname||' ) ' fullUserName
			</selectClause>
			<tableClause>ccare.users </tableClause>
			<whereClause><![CDATA[
				1 = 1
				]]>
			</whereClause>
			<orderClause>fullUserName</orderClause>
		</operationBinding>
		
	</operationBindings>
</DataSource>