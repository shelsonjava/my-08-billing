<DataSource
	ID="EntPosterDS"
	serverType="sql"
	tableName="ccare.ent_posters"
	qualifyColumnNames="false"
	dropExtraFields = "false">
	<fields>
		<field name="event_id"				type="integer"		title="ID"							hidden="true" primaryKey="true" />
		<field name="event_owner_name"				type="text"			title="event_owner_name"/>
		<field name="event_name"			type="text"			title="event_name"/>
		<field name="remark"				type="text"			title="Remark"/>
		<field name="event_date"				type="datetime"		title="event_date"/>
		<field name="event_price"			type="text"			title="event_price"/>
		<field name="poster_time"				type="text"			title="poster_time"/>
		<field name="sms_remark"				type="text"			title="Sms Remark"/>
		<field name="date_criteria"					type="integer"		title="date_criteria" 					hidden="true"/>
		<field name="date_visibility"				type="integer"		title="date_visibility" 					hidden="true"/>
		<field name="event_owner_id"				type="integer"		title="event_owner_id" 				hidden="true"/>
		<field name="loggedUserName"			type="text"			title="Logged UserName" 			hidden="true"/>	
		<field name="event_category_id"				type="integer"		title="Ent Type Id" 				hidden="true"/>	
		<field name="eventDateTime"			type="text"			title="eventDateTime"/>
		<field name="scheduleitemid"			type="integer"		title="scheduleitemid" 				hidden="true"/>
		<field name="scheduleplaceid"			type="integer"		title="scheduleplaceid" 			hidden="true"/>
		<field name="itemname"					type="text"			title="itemname"/>
		<field name="itemdate"					type="text"			title="itemdate"/>
		<field name="info"						type="text"			title="info"/>
		<field name="kkd"						type="datetime"		title="kkd"/>
		<field name="price"						type="text"			title="price"/>
		<field name="fullinfo"					type="text"			title="fullinfo"/>
		<field name="morder"					type="text"			title="morder"						hidden="true"/>
		<field name="main_id"					type="integer"		title="main_id" 					hidden="true"/>
		<field name="service_id"				type="integer"		title="service_id" 					hidden="true"/>
		<field name="new_itm_date"				type="text"			title="new_itm_date"/>
		<field name="new_itm_date_time"			type="text"			title="new_itm_date_time"/>
	</fields>

	<operationBindings>		

		<serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.EntDMI"/>

		<!-- Add EntPoster -->
		<operationBinding operationType="add" operationId="addEntPoster" serverMethod="addEntPoster">
            <serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.EntDMI"/>
        </operationBinding>
        
		<!-- EntPoster Update -->
		<operationBinding operationType="update" operationId="updateEntPoster" serverMethod="updateEntPoster">
            <serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.EntDMI"/>
        </operationBinding>
        
        <!-- EntPoster Status Update -->
		<operationBinding operationType="update" operationId="updateEntPosterStatus" serverMethod="updateEntPosterStatus">
            <serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.EntDMI"/>
        </operationBinding>
        
        <!-- EntPoster Delete -->
		<operationBinding operationType="remove" operationId="deleteEntPoster" serverMethod="deleteEntPoster">
            <serverObject lookupStyle="new" className="com.info08.billing.callcenterbk.server.impl.dmi.EntDMI"/>
        </operationBinding>
	
    	<operationBinding operationId="searchAllEntPosters" operationType="fetch">
    		<selectClause>   			
    			t.event_id,
				t.comment_eng,
				t.remark,
				t.date_criteria,
				t.date_visibility,
				t.event_owner_id,
				t.ent_poster_eng,
				t.event_name,
				t.event_date,
				t.poster_price_eng,
				t.event_price,
				t.poster_time,
				t.rec_date,
				t.rec_user,
				t.upd_date,
				t.upd_user,    
				ep.event_owner_name,
				t.sms_remark,
				ep.event_category_id,
				trim(to_char(t.event_date,'DD-MM-YYYY')||' '||t.poster_time) as eventDateTime
			</selectClause> 
			<tableClause>ent_posters t, ent_places ep</tableClause>
			<whereClause><![CDATA[
				t.event_owner_id = ep.event_owner_id
				#if($criteria.event_category_id) and ep.event_category_id = $criteria.event_category_id #end
				#if($criteria.event_owner_id) and t.event_owner_id = $criteria.event_owner_id #end
				#if($criteria.event_name) and t.event_name like ($criteria.event_name)||'%' #end
				#if($criteria.remark) and t.remark like ($criteria.remark)||'%' #end
				#if($criteria.event_price) and t.event_price like ($criteria.event_price)||'%' #end
				#if($criteria.event_date_start) and trunc(t.event_date) >= trunc($criteria.event_date_start) #end
				#if($criteria.event_date_end) and trunc(t.event_date) <= trunc($criteria.event_date_end) #end
				]]>  
			</whereClause> 
			<orderClause>t.event_id</orderClause>
    	</operationBinding>
    	
    	
    	
    	<operationBinding operationId="searchAllEntPostersForCallCenter" operationType="fetch">
    		<selectClause>   			
    			   t.scheduleitemid,
			       t.scheduleplaceid,
			       t.itemname,
			       t.info,
			       t.itemdate,
			       t.kkd,
			       t.price,
			       t.fullinfo,
			       t.morder,
			       ep.event_owner_name,
       			   ep.main_id,
       			   ms.service_id,
       			   t.new_itm_date,
       			   t.new_itm_date_time       			   
			</selectClause> 
			<tableClause>scheduleitems t, ent_places ep, main_services ms</tableClause>
			<whereClause><![CDATA[
				t.scheduleplaceid = ep.event_owner_id and ep.main_id = ms.main_id(+)
				#if($criteria.scheduleplaceid) and t.scheduleplaceid = $criteria.scheduleplaceid #end
				#if($criteria.kkd) and trunc(t.kkd) = trunc($criteria.kkd) #end
				#if($criteria.entPostGeoAndCom) 
					and (t.itemname like '%'||$criteria.entPostGeoAndCom||'%' or t.fullinfo like '%'||$criteria.entPostGeoAndCom||'%') 
				#end
				
				]]>  
			</whereClause> 
			<orderClause>t.morder, t.itemdate, t.itemname</orderClause>
    	</operationBinding>
    	
    	
    	
    	<operationBinding operationId="searchAllEntPostersForCallCenter1" operationType="fetch">
    		<selectClause>   			
    			t.event_id as scheduleItemID,
				t.comment_eng,
				nvl(t.remark, '_') as info,
				t.date_criteria,
				t.date_visibility,
				t.event_owner_id as schedulePlaceID,
				t.ent_poster_eng,
				nvl(t.event_name, '_') as itemName,
				t.event_date,
				t.poster_price_eng,
				t.event_price,
				t.poster_time,
				t.rec_date,
				t.rec_user,
				t.upd_date,
				t.upd_user,    
				ep.event_owner_name,
				t.sms_remark,
				ep.event_category_id,
				trim(to_char(t.event_date,'DD-MM-YYYY')||' '||t.poster_time) as eventDateTime,
				decode(t.date_visibility, 0, TO_CHAR(t.event_date, 'dd-mm-yy') || ' ' || t.poster_time, '--------------') itemDate,
				to_date(t.event_date || ':' || decode(t.poster_time, null, '00:01', t.poster_time), 'dd/mm/yy:HH24:mi') kkd,
				nvl(t.event_price, '_') price,
				t.event_name || ' ' || t.remark as fullInfo,
				to_char(t.event_date, 'mm/yy') morder
				
			</selectClause> 
			<tableClause>ent_posters t, ent_places ep</tableClause>
			<whereClause><![CDATA[
				t.event_owner_id = ep.event_owner_id 
				and (trunc(t.event_date) >= trunc(sysdate) - 1 or t.date_criteria not in (0))
				#if($criteria.event_category_id) and ep.event_category_id = $criteria.event_category_id #end
				#if($criteria.event_owner_id) and t.event_owner_id = $criteria.event_owner_id #end
				#if($criteria.event_name) and t.event_name like ($criteria.event_name)||'%' #end
				#if($criteria.remark) and t.remark like ($criteria.remark)||'%' #end
				#if($criteria.event_price) and t.event_price like ($criteria.event_price)||'%' #end
				#if($criteria.event_date_start) and trunc(t.event_date) >= trunc($criteria.event_date_start) #end
				#if($criteria.event_date_end) and trunc(t.event_date) <= trunc($criteria.event_date_end) #end
				
				#if($criteria.event_date_p) and (trunc(t.event_date) = trunc($criteria.event_date_p) or t.date_criteria not in (0)) #end
				
				#if($criteria.scheduleplaceid) and t.event_owner_id = $criteria.scheduleplaceid #end
				#if($criteria.entPostGeoAndCom) 
					and (
						  nvl(t.event_name, '_') like '%'||$criteria.entPostGeoAndCom||'%' or 
						  (t.event_name || ' ' || t.remark) like '%'||$criteria.entPostGeoAndCom||'%'
						) 
				#end
				
				#if($criteria.entPostGeoAndCom1) 
					and (
						  nvl(t.event_name, '_') like '%'||$criteria.entPostGeoAndCom1||'%' or 
						  (t.event_name || ' ' || t.remark) like '%'||$criteria.entPostGeoAndCom1||'%'
						) 
				#end
				#if($criteria.entPostGeoAndCom2) 
					and (
						  nvl(t.event_name, '_') like '%'||$criteria.entPostGeoAndCom2||'%' or 
						  (t.event_name || ' ' || t.remark) like '%'||$criteria.entPostGeoAndCom2||'%'
						) 
				#end
				#if($criteria.entPostGeoAndCom3) 
					and (
						  nvl(t.event_name, '_') like '%'||$criteria.entPostGeoAndCom3||'%' or 
						  (t.event_name || ' ' || t.remark) like '%'||$criteria.entPostGeoAndCom3||'%'
						) 
				#end
				#if($criteria.entPostGeoAndCom4) 
					and (
						  nvl(t.event_name, '_') like '%'||$criteria.entPostGeoAndCom4||'%' or 
						  (t.event_name || ' ' || t.remark) like '%'||$criteria.entPostGeoAndCom4||'%'
						) 
				#end
				#if($criteria.entPostGeoAndCom5) 
					and (
						  nvl(t.event_name, '_') like '%'||$criteria.entPostGeoAndCom5||'%' or 
						  (t.event_name || ' ' || t.remark) like '%'||$criteria.entPostGeoAndCom5||'%'
						) 
				#end
				
				
				
				]]>  
			</whereClause> 
			<orderClause>to_char(t.event_date, 'mm/yy'), decode(t.date_visibility, 0, TO_CHAR(t.event_date, 'dd-mm-yy') || ' ' || t.poster_time, '--------------'), nvl(t.event_name, '_')</orderClause>
    	</operationBinding>
    	
    	
    	
    </operationBindings>	
</DataSource>